# はてなマークダウン管理ツール 要件定義書

## 1. プロジェクト概要

### 1.1 目的
はてなブログAPIを使用して、マークダウン形式で記事を管理するコマンドラインツールを開発する。ローカル環境でマークダウンファイルを編集し、はてなブログに投稿・更新できるようにする。

### 1.2 背景
はてなブログの記事をローカル環境で管理したいというニーズに応えるため、マークダウンファイルとはてなブログの記事を同期できるツールが必要とされている。

### 1.3 スコープ
- はてなブログAPIを使用した記事の取得、投稿、更新
- マークダウン形式での記事管理
- コマンドラインインターフェースの提供

## 2. 機能要件

### 2.1 記事一覧の取得
- はてなブログから記事一覧を取得して表示する
- 下書き/公開記事のフィルタリング機能
- 取得する記事数の制限設定

### 2.2 記事の取得（ダウンロード）
- 指定したIDの記事をダウンロードしてマークダウンファイルとして保存
- HTML形式の記事をマークダウンに変換
- メタデータ（タイトル、カテゴリなど）をFrontMatter形式で保存

### 2.3 記事の新規作成
- マークダウンファイルから新規記事を作成
- タイトル、カテゴリ、公開状態の設定
- 作成した記事のIDを取得して表示

### 2.4 記事の更新
- マークダウンファイルから既存記事を更新
- メタデータ（タイトル、カテゴリなど）の更新
- 公開状態の変更（下書き⇔公開）

### 2.5 下書きの管理
- 下書き記事の一覧表示
- 下書き記事の公開

## 3. 非機能要件

### 3.1 パフォーマンス
- APIリクエストの効率化（必要最小限のリクエスト）
- 大量の記事を扱う場合のページネーション対応

### 3.2 セキュリティ
- API認証情報の安全な管理
- 設定ファイルのパーミッション管理

### 3.3 使いやすさ
- 直感的なコマンド体系
- 詳細なヘルプメッセージ
- エラー時の分かりやすいメッセージ

### 3.4 拡張性
- 新機能の追加が容易な設計
- モジュール分割による保守性の向上

## 4. 制約条件

### 4.1 技術的制約
- Python 3.11以上で動作すること
- 依存ライブラリ：requests, html2text
- はてなブログAPIの制限に準拠すること

### 4.2 環境的制約
- ローカル環境での実行を前提とする
- 設定ファイルはユーザーのホームディレクトリに保存

## 5. ユーザーインターフェース

### 5.1 コマンドライン構造
```
question-md list                      # 記事一覧を表示
question-md get <entry_id>            # 記事をダウンロード
question-md create <file> [options]   # 新規記事を作成
question-md update <entry_id> <file>  # 記事を更新
question-md drafts list               # 下書き一覧
question-md drafts publish <entry_id> # 下書きを公開
question-md config                    # 設定の確認・変更
```

### 5.2 オプション
- `--limit`: 取得する記事数の制限
- `--draft`: 下書き記事のみ表示/下書きとして保存
- `--output`: 出力ファイルパス
- `--title`: 記事タイトル
- `--categories`: カテゴリ（複数指定可）
- `--format`: 出力形式（テキスト、JSON等）

## 6. データ設計

### 6.1 設定ファイル
```json
{
  "hatena_id": "ユーザーID",
  "blog_id": "ブログID",
  "api_key": "APIキー",
  "default_output_dir": "デフォルト出力ディレクトリ"
}
```

### 6.2 マークダウンファイル形式
```markdown
---
title: 記事タイトル
categories:
  - カテゴリ1
  - カテゴリ2
draft: true
id: 12345678901234567
---

# 記事の本文

これは記事の本文です...
```

## 7. 実装計画

### 7.1 フェーズ1：基本機能の実装
- 設定管理モジュール
- はてなAPI連携モジュール
- マークダウン処理モジュール
- 基本的なCLIコマンド（list, get）

### 7.2 フェーズ2：記事管理機能の実装
- 記事作成・更新コマンド
- 下書き管理コマンド

### 7.3 フェーズ3：拡張機能の実装
- バッチ処理（複数記事の一括操作）
- 出力形式のカスタマイズ
- エラーハンドリングの強化
